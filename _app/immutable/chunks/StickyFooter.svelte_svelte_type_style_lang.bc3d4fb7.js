import{s as de,h as X,r as be,b as J,n as Ce,k as Le,l as Ie,d as Ge,u as qe,g as ze,e as We,j as Y}from"./scheduler.3014b167.js";import{S as fe,i as ae,g as y,s as N,m as me,h as O,j as S,x as K,c as A,n as _e,f as C,k as v,l as W,a as P,y as w,C as Q,z as q,o as ge,D as ee,d as B,p as oe,t as H,b as re,A as Ue,B as Z,r as te,u as le,v as ne,w as ie}from"./index.c71d7625.js";import{e as ue}from"./each.e59479a4.js";import{w as Xe}from"./index.e01a64da.js";import{w as Je}from"./stores.c9a950bc.js";function Ke(t){let e,l,i,o="code length",s,n,r,u,a,c,d,p,m,k,f,g="base",M,h,b,E;return{c(){e=y("div"),l=y("div"),i=y("label"),i.textContent=o,s=N(),n=y("div"),r=y("input"),u=N(),a=y("p"),c=me(t[0]),d=N(),p=y("hr"),m=N(),k=y("div"),f=y("label"),f.textContent=g,M=N(),h=y("input"),this.h()},l(D){e=O(D,"DIV",{style:!0,class:!0});var V=S(e);l=O(V,"DIV",{class:!0});var _=S(l);i=O(_,"LABEL",{for:!0,style:!0,class:!0,"data-svelte-h":!0}),K(i)!=="svelte-wgfsn5"&&(i.textContent=o),s=A(_),n=O(_,"DIV",{class:!0});var j=S(n);r=O(j,"INPUT",{id:!0,type:!0,name:!0,min:!0,max:!0}),u=A(j),a=O(j,"P",{});var L=S(a);c=_e(L,t[0]),L.forEach(C),j.forEach(C),_.forEach(C),d=A(V),p=O(V,"HR",{class:!0}),m=A(V),k=O(V,"DIV",{class:!0});var G=S(k);f=O(G,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(f)!=="svelte-f24ihi"&&(f.textContent=g),M=A(G),h=O(G,"INPUT",{id:!0,type:!0,min:!0,max:!0,style:!0}),G.forEach(C),V.forEach(C),this.h()},h(){v(i,"for","codeLength"),W(i,"text-align","left"),v(i,"class","svelte-1incui1"),v(r,"id","codeLength"),v(r,"type","range"),v(r,"name","codeLength"),v(r,"min","3"),v(r,"max","6"),v(n,"class","flex center space-between"),v(l,"class","flex center space-between svelte-1incui1"),v(p,"class","svelte-1incui1"),v(f,"for","base"),v(f,"class","svelte-1incui1"),v(h,"id","base"),v(h,"type","number"),v(h,"min","3"),v(h,"max","36"),W(h,"width","3rem"),v(k,"class","flex center space-between svelte-1incui1"),W(e,"margin","2rem"),v(e,"class","controls svelte-1incui1")},m(D,V){P(D,e,V),w(e,l),w(l,i),w(l,s),w(l,n),w(n,r),Q(r,t[0]),w(n,u),w(n,a),w(a,c),w(e,d),w(e,p),w(e,m),w(e,k),w(k,f),w(k,M),w(k,h),Q(h,t[1]),b||(E=[q(r,"change",t[2]),q(r,"input",t[2]),q(h,"input",t[3])],b=!0)},p(D,[V]){V&1&&Q(r,D[0]),V&1&&ge(c,D[0]),V&2&&ee(h.value)!==D[1]&&Q(h,D[1])},i:X,o:X,d(D){D&&C(e),b=!1,be(E)}}}function Qe(t,e,l){let{codeLength:i,base:o}=e;function s(){i=ee(this.value),l(0,i)}function n(){o=ee(this.value),l(1,o)}return t.$$set=r=>{"codeLength"in r&&l(0,i=r.codeLength),"base"in r&&l(1,o=r.base)},[i,o,s,n]}class Ye extends fe{constructor(e){super(),ae(this,e,Qe,Ke,de,{codeLength:0,base:1})}}function Ze(t){if(!t.length)return;const e=t.split(/\s/).filter(i=>i.length),l=[];for(;e.length;){const i={code:e.shift().split("").map(Math.floor),included:Math.floor(e.shift()),sorted:Math.floor(e.shift())};l.push(i)}return l}function xe(t){if(t.length)return t.map(e=>`${e.code.join("")} ${e.included} ${e.sorted}
`).join("")}function ye(t){let e,l="import",i,o,s,n;return{c(){e=y("button"),e.textContent=l,i=N(),o=y("input"),this.h()},l(r){e=O(r,"BUTTON",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1239hf0"&&(e.textContent=l),i=A(r),o=O(r,"INPUT",{style:!0,type:!0,name:!0,id:!0,class:!0}),this.h()},h(){v(e,"class","svelte-8b46u0"),W(o,"display","none"),v(o,"type","file"),v(o,"name","file"),v(o,"id","fileInput"),v(o,"class","svelte-8b46u0")},m(r,u){P(r,e,u),P(r,i,u),P(r,o,u),t[8](o),s||(n=[q(e,"click",t[7]),q(o,"change",t[3])],s=!0)},p:X,d(r){r&&(C(e),C(i),C(o)),t[8](null),s=!1,be(n)}}}function Oe(t){let e,l="export",i,o,s,n;return{c(){e=y("button"),e.textContent=l,i=N(),o=y("a"),this.h()},l(r){e=O(r,"BUTTON",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1y72hyi"&&(e.textContent=l),i=A(r),o=O(r,"A",{style:!0,class:!0}),S(o).forEach(C),this.h()},h(){v(e,"class","svelte-8b46u0"),W(o,"display","none"),v(o,"class","svelte-8b46u0")},m(r,u){P(r,e,u),P(r,i,u),P(r,o,u),t[9](o),s||(n=q(e,"click",t[4]),s=!0)},p:X,d(r){r&&(C(e),C(i),C(o)),t[9](null),s=!1,n()}}}function $e(t){let e,l,i=t[0].import&&ye(t),o=t[0].export&&Oe(t);return{c(){e=y("div"),i&&i.c(),l=N(),o&&o.c(),this.h()},l(s){e=O(s,"DIV",{class:!0});var n=S(e);i&&i.l(n),l=A(n),o&&o.l(n),n.forEach(C),this.h()},h(){v(e,"class","bigbox flex center svelte-8b46u0")},m(s,n){P(s,e,n),i&&i.m(e,null),w(e,l),o&&o.m(e,null)},p(s,[n]){s[0].import?i?i.p(s,n):(i=ye(s),i.c(),i.m(e,l)):i&&(i.d(1),i=null),s[0].export?o?o.p(s,n):(o=Oe(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i:X,o:X,d(s){s&&C(e),i&&i.d(),o&&o.d()}}}function et(t,e,l){let{options:i={import:!1,export:!1},riddle:o,onimport:s=()=>{}}=e,n,r;function u(m){n.files[0].text().then(k=>{s(Ze(k))}),l(1,n.value="",n)}function a(m){l(2,r.href="data:text/plain;charset=utf-8,"+xe(o),r),l(2,r.download=new Date().toString(),r),r.click()}const c=()=>n.click();function d(m){J[m?"unshift":"push"](()=>{n=m,l(1,n)})}function p(m){J[m?"unshift":"push"](()=>{r=m,l(2,r)})}return t.$$set=m=>{"options"in m&&l(0,i=m.options),"riddle"in m&&l(5,o=m.riddle),"onimport"in m&&l(6,s=m.onimport)},[i,n,r,u,a,o,s,c,d,p]}class tt extends fe{constructor(e){super(),ae(this,e,et,$e,de,{options:0,riddle:5,onimport:6})}}function lt(t){let e,l,i,o;return{c(){e=y("input"),this.h()},l(s){e=O(s,"INPUT",{class:!0,type:!0,min:!0,max:!0}),this.h()},h(){v(e,"class",l=Ce(t[3].class)+" svelte-1w4vbzd"),e.disabled=t[1],v(e,"type","number"),v(e,"min","0"),v(e,"max",t[2])},m(s,n){P(s,e,n),Q(e,t[0]),i||(o=[q(e,"focus",nt),q(e,"input",t[4])],i=!0)},p(s,[n]){n&8&&l!==(l=Ce(s[3].class)+" svelte-1w4vbzd")&&v(e,"class",l),n&2&&(e.disabled=s[1]),n&4&&v(e,"max",s[2]),n&1&&ee(e.value)!==s[0]&&Q(e,s[0])},i:X,o:X,d(s){s&&C(e),i=!1,be(o)}}}const nt=t=>t.target.select();function it(t,e,l){let{value:i,disabled:o,max:s}=e;function n(){i=ee(this.value),l(0,i)}return t.$$set=r=>{l(3,e=Le(Le({},e),Ie(r))),"value"in r&&l(0,i=r.value),"disabled"in r&&l(1,o=r.disabled),"max"in r&&l(2,s=r.max)},e=Ie(e),[i,o,s,e,n]}class pe extends fe{constructor(e){super(),ae(this,e,it,lt,de,{value:0,disabled:1,max:2})}}function je(t,e,l){const i=t.slice();return i[20]=e[l],i[21]=e,i[22]=l,i}function Te(t,e,l){const i=t.slice();return i[23]=e[l],i[24]=e,i[25]=l,i}function De(t){let e,l='<div class="flex center mobile-inst space-between svelte-w99aus"><p>incl</p><p>=</p><p class="included svelte-w99aus">included</p></div> <div class="flex center mobile-inst space-between svelte-w99aus"><p>sort</p><p>=</p><p class="sorted svelte-w99aus">sorted</p></div>';return{c(){e=y("div"),e.innerHTML=l,this.h()},l(i){e=O(i,"DIV",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-t6ue9k"&&(e.innerHTML=l),this.h()},h(){v(e,"class","mobile-inst-box svelte-w99aus")},m(i,o){P(i,e,o)},d(i){i&&C(e)}}}function Re(t){let e,l,i;function o(n){t[13](n)}let s={options:t[3]?t[7]:t[5],onimport:t[10]};return t[1]!==void 0&&(s.riddle=t[1]),e=new tt({props:s}),J.push(()=>Z(e,"riddle",o)),{c(){te(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,r){ne(e,n,r),i=!0},p(n,r){const u={};r&40&&(u.options=n[3]?n[7]:n[5]),!l&&r&2&&(l=!0,u.riddle=n[1],Y(()=>l=!1)),e.$set(u)},i(n){i||(B(e.$$.fragment,n),i=!0)},o(n){H(e.$$.fragment,n),i=!1},d(n){ie(e,n)}}}function Ve(t){let e,l,i,o;function s(u){t[14](u)}function n(u){t[15](u)}let r={};return t[0]!==void 0&&(r.codeLength=t[0]),t[2]!==void 0&&(r.base=t[2]),e=new Ye({props:r}),J.push(()=>Z(e,"codeLength",s)),J.push(()=>Z(e,"base",n)),{c(){te(e.$$.fragment)},l(u){le(e.$$.fragment,u)},m(u,a){ne(e,u,a),o=!0},p(u,a){const c={};!l&&a&1&&(l=!0,c.codeLength=u[0],Y(()=>l=!1)),!i&&a&4&&(i=!0,c.base=u[2],Y(()=>i=!1)),e.$set(c)},i(u){o||(B(e.$$.fragment,u),o=!0)},o(u){H(e.$$.fragment,u),o=!1},d(u){ie(e,u)}}}function Be(t){let e,l,i;function o(n){t[16](n,t[23],t[24],t[25])}let s={max:t[2]-1,disabled:!t[3]};return t[23]!==void 0&&(s.value=t[23]),e=new pe({props:s}),J.push(()=>Z(e,"value",o)),{c(){te(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,r){ne(e,n,r),i=!0},p(n,r){t=n;const u={};r&4&&(u.max=t[2]-1),r&8&&(u.disabled=!t[3]),!l&&r&2&&(l=!0,u.value=t[23],Y(()=>l=!1)),e.$set(u)},i(n){i||(B(e.$$.fragment,n),i=!0)},o(n){H(e.$$.fragment,n),i=!1},d(n){ie(e,n)}}}function Se(t){let e,l="x",i,o;function s(){return t[19](t[22])}return{c(){e=y("button"),e.textContent=l,this.h()},l(n){e=O(n,"BUTTON",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1w4m1lm"&&(e.textContent=l),this.h()},h(){v(e,"class","delete-button svelte-w99aus")},m(n,r){P(n,e,r),i||(o=q(e,"click",s),i=!0)},p(n,r){t=n},d(n){n&&C(e),i=!1,o()}}}function Ne(t){let e,l,i,o,s,n,r,u,a,c,d=t[6]?"incl":"included",p,m,k,f,g,M,h,b,E=t[6]?"sort":"sorted",D,V,_,j=ue(t[20].code),L=[];for(let I=0;I<j.length;I+=1)L[I]=Be(Te(t,j,I));const G=I=>H(L[I],1,1,()=>{L[I]=null});function Pe(I){t[17](I,t[20])}let ve={disabled:!t[3],max:t[0]};t[20].included!==void 0&&(ve.value=t[20].included),r=new pe({props:ve}),J.push(()=>Z(r,"value",Pe));function Fe(I){t[18](I,t[20])}let ke={disabled:!t[3],max:t[20].included};t[20].sorted!==void 0&&(ke.value=t[20].sorted),g=new pe({props:ke}),J.push(()=>Z(g,"value",Fe));let U=t[3]&&Se(t);return{c(){e=y("div"),l=y("div");for(let I=0;I<L.length;I+=1)L[I].c();i=N(),o=y("div"),s=y("div"),n=y("div"),te(r.$$.fragment),a=N(),c=y("label"),p=me(d),m=N(),k=y("div"),f=y("div"),te(g.$$.fragment),h=N(),b=y("label"),D=me(E),V=N(),U&&U.c(),this.h()},l(I){e=O(I,"DIV",{class:!0,style:!0});var T=S(e);l=O(T,"DIV",{class:!0});var F=S(l);for(let ce=0;ce<L.length;ce+=1)L[ce].l(F);F.forEach(C),i=A(T),o=O(T,"DIV",{class:!0});var z=S(o);s=O(z,"DIV",{class:!0});var R=S(s);n=O(R,"DIV",{class:!0});var x=S(n);le(r.$$.fragment,x),x.forEach(C),a=A(R),c=O(R,"LABEL",{for:!0});var we=S(c);p=_e(we,d),we.forEach(C),R.forEach(C),m=A(z),k=O(z,"DIV",{class:!0});var se=S(k);f=O(se,"DIV",{class:!0});var Ee=S(f);le(g.$$.fragment,Ee),Ee.forEach(C),h=A(se),b=O(se,"LABEL",{for:!0});var Me=S(b);D=_e(Me,E),Me.forEach(C),se.forEach(C),z.forEach(C),V=A(T),U&&U.l(T),T.forEach(C),this.h()},h(){v(l,"class","code svelte-w99aus"),v(n,"class","included svelte-w99aus"),v(c,"for","included"),v(s,"class","flex column"),v(f,"class","sorted svelte-w99aus"),v(b,"for","sorted"),v(k,"class","flex column"),v(o,"class","flex svelte-w99aus"),v(e,"class","hint flex center svelte-w99aus"),W(e,"align-items","flex-start")},m(I,T){P(I,e,T),w(e,l);for(let F=0;F<L.length;F+=1)L[F]&&L[F].m(l,null);w(e,i),w(e,o),w(o,s),w(s,n),ne(r,n,null),w(s,a),w(s,c),w(c,p),w(o,m),w(o,k),w(k,f),ne(g,f,null),w(k,h),w(k,b),w(b,D),w(e,V),U&&U.m(e,null),_=!0},p(I,T){if(t=I,T&14){j=ue(t[20].code);let R;for(R=0;R<j.length;R+=1){const x=Te(t,j,R);L[R]?(L[R].p(x,T),B(L[R],1)):(L[R]=Be(x),L[R].c(),B(L[R],1),L[R].m(l,null))}for(oe(),R=j.length;R<L.length;R+=1)G(R);re()}const F={};T&8&&(F.disabled=!t[3]),T&1&&(F.max=t[0]),!u&&T&2&&(u=!0,F.value=t[20].included,Y(()=>u=!1)),r.$set(F),(!_||T&64)&&d!==(d=t[6]?"incl":"included")&&ge(p,d);const z={};T&8&&(z.disabled=!t[3]),T&2&&(z.max=t[20].included),!M&&T&2&&(M=!0,z.value=t[20].sorted,Y(()=>M=!1)),g.$set(z),(!_||T&64)&&E!==(E=t[6]?"sort":"sorted")&&ge(D,E),t[3]?U?U.p(t,T):(U=Se(t),U.c(),U.m(e,null)):U&&(U.d(1),U=null)},i(I){if(!_){for(let T=0;T<j.length;T+=1)B(L[T]);B(r.$$.fragment,I),B(g.$$.fragment,I),_=!0}},o(I){L=L.filter(Boolean);for(let T=0;T<L.length;T+=1)H(L[T]);H(r.$$.fragment,I),H(g.$$.fragment,I),_=!1},d(I){I&&C(e),Ue(L,I),ie(r),ie(g),U&&U.d()}}}function Ae(t){let e,l="+",i,o;return{c(){e=y("button"),e.textContent=l,this.h()},l(s){e=O(s,"BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),K(e)!=="svelte-sxuadl"&&(e.textContent=l),this.h()},h(){v(e,"id","addButton"),W(e,"margin","1.5rem"),W(e,"padding",".2rem 1rem")},m(s,n){P(s,e,n),i||(o=q(e,"click",t[9]),i=!0)},p:X,d(s){s&&C(e),i=!1,o()}}}function st(t){let e,l,i,o,s,n,r,u,a=t[6]&&De(),c=(t[3]||t[5])&&Re(t),d=(t[4]||t[3])&&Ve(t);const p=t[12].default,m=Ge(p,t,t[11],null);let k=ue(t[1]??[]),f=[];for(let h=0;h<k.length;h+=1)f[h]=Ne(je(t,k,h));const g=h=>H(f[h],1,1,()=>{f[h]=null});let M=t[3]&&Ae(t);return{c(){e=y("div"),a&&a.c(),l=N(),c&&c.c(),i=N(),d&&d.c(),o=N(),s=y("div"),m&&m.c(),n=N();for(let h=0;h<f.length;h+=1)f[h].c();r=N(),M&&M.c(),this.h()},l(h){e=O(h,"DIV",{class:!0});var b=S(e);a&&a.l(b),l=A(b),c&&c.l(b),i=A(b),d&&d.l(b),o=A(b),s=O(b,"DIV",{style:!0});var E=S(s);m&&m.l(E),E.forEach(C),n=A(b);for(let D=0;D<f.length;D+=1)f[D].l(b);r=A(b),M&&M.l(b),b.forEach(C),this.h()},h(){W(s,"margin-bottom","1rem"),v(e,"class","bigbox flex column center svelte-w99aus")},m(h,b){P(h,e,b),a&&a.m(e,null),w(e,l),c&&c.m(e,null),w(e,i),d&&d.m(e,null),w(e,o),w(e,s),m&&m.m(s,null),w(e,n);for(let E=0;E<f.length;E+=1)f[E]&&f[E].m(e,null);w(e,r),M&&M.m(e,null),u=!0},p(h,[b]){if(h[6]?a||(a=De(),a.c(),a.m(e,l)):a&&(a.d(1),a=null),h[3]||h[5]?c?(c.p(h,b),b&40&&B(c,1)):(c=Re(h),c.c(),B(c,1),c.m(e,i)):c&&(oe(),H(c,1,1,()=>{c=null}),re()),h[4]||h[3]?d?(d.p(h,b),b&24&&B(d,1)):(d=Ve(h),d.c(),B(d,1),d.m(e,o)):d&&(oe(),H(d,1,1,()=>{d=null}),re()),m&&m.p&&(!u||b&2048)&&qe(m,p,h,h[11],u?We(p,h[11],b,null):ze(h[11]),null),b&335){k=ue(h[1]??[]);let E;for(E=0;E<k.length;E+=1){const D=je(h,k,E);f[E]?(f[E].p(D,b),B(f[E],1)):(f[E]=Ne(D),f[E].c(),B(f[E],1),f[E].m(e,r))}for(oe(),E=k.length;E<f.length;E+=1)g(E);re()}h[3]?M?M.p(h,b):(M=Ae(h),M.c(),M.m(e,null)):M&&(M.d(1),M=null)},i(h){if(!u){B(c),B(d),B(m,h);for(let b=0;b<k.length;b+=1)B(f[b]);u=!0}},o(h){H(c),H(d),H(m,h),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)H(f[b]);u=!1},d(h){h&&C(e),a&&a.d(),c&&c.d(),d&&d.d(),m&&m.d(h),Ue(f,h),M&&M.d()}}}function ot(t,e,l){let{$$slots:i={},$$scope:o}=e,{codeLength:s=3,riddle:n,contenteditable:r=!1,base:u=10,showControls:a=!1,fileSettings:c}=e;const d={import:!0,export:!0},p=Xe(r?n||[{code:Array.from({length:s},()=>0),included:0,sorted:0}]:n);function m(){const _={code:Array.from({length:s},()=>0),included:0,sorted:0};p.update(j=>j.concat(_))}function k(_){l(0,s=_[0].code.length),p.set(_)}p.subscribe(_=>l(1,n=_));let f=!1;Je.subscribe(_=>{l(6,f=_.isMobile)});function g(_){n=_,l(1,n)}function M(_){s=_,l(0,s)}function h(_){u=_,l(2,u)}function b(_,j,L,G){L[G]=_,l(1,n)}function E(_,j){t.$$.not_equal(j.included,_)&&(j.included=_,l(1,n))}function D(_,j){t.$$.not_equal(j.sorted,_)&&(j.sorted=_,l(1,n))}const V=_=>{p.update(j=>n.filter((L,G)=>G!=_))};return t.$$set=_=>{"codeLength"in _&&l(0,s=_.codeLength),"riddle"in _&&l(1,n=_.riddle),"contenteditable"in _&&l(3,r=_.contenteditable),"base"in _&&l(2,u=_.base),"showControls"in _&&l(4,a=_.showControls),"fileSettings"in _&&l(5,c=_.fileSettings),"$$scope"in _&&l(11,o=_.$$scope)},t.$$.update=()=>{t.$$.dirty&11&&r&&(p.update(_=>n),p.update(_=>_==null?void 0:_.map(j=>{for(;j.code.length!=s;)j.code.length>s?j.code.pop():j.code.push(0);return j})))},[s,n,u,r,a,c,f,d,p,m,k,o,i,g,M,h,b,E,D,V]}class Et extends fe{constructor(e){super(),ae(this,e,ot,st,de,{codeLength:0,riddle:1,contenteditable:3,base:2,showControls:4,fileSettings:5})}}const $=t=>"0".repeat(t).split("").map(e=>({include:{},exclude:{}})),he=t=>t.reduce((e,l)=>({include:{...e.include,...l.include},exclude:{...e.exclude,...l.exclude}}));function rt(t,e=10,l=!0){const i=t.map(u=>at(u,e)),o=t[0].code.length,s=[];function n(u=-1,a=$(o)){for(const c of i[u+1]){const d=dt(a,c);d&&(u+1==i.length-1?s.push(d):n(u+1,d))}}n();const r=s.map(u=>ut(u,e)).filter(u=>u);return l?r:r.filter(u=>!u.some((a,c,d)=>d.indexOf(a)!=c))}function ut(t,e=10){const l=s=>t.reduce((n,r)=>n+Object.keys(r.include).map(Math.floor).filter(u=>u==s).length,0),i=()=>t.flatMap(s=>Object.keys(s.include).map(Math.floor).filter(r=>l(r)==1)),o=()=>t.flatMap(s=>{const n=Object.keys(s.include).map(Math.floor);return n.length==1?n:[]});t.forEach(s=>{if(Object.keys(s.exclude).length==e-1)for(let n=0;n<e;n++)s.exclude[n]||(s.include[n]=!0)});for(let s=i(),n=o(),r=!0;r;s=i()){r=!1;for(const u of s)t.forEach(a=>{for(const c in a.include)c!=u&&a.include[u]&&(delete a.include[c],r=!0)});for(const u of n)t.forEach(a=>{Object.keys(a.include).length>1&&a.include[u]&&(delete a.include[u],r=!0)});n=o()}if(t.every(s=>Object.keys(s.include).length==1))return t.map(s=>Math.floor(Object.keys(s.include)[0]))}function dt(t,e){const l=ft(t,e),i=he(l),o=he(t),s=he(e);if([o,s].every(n=>Object.keys(n.include).every(r=>i.include[r])))return l}function ft(t,e){const l=t.length,i=$(l);for(let o=0;o<l;o++){i[o].include={...t[o].include,...e[o].include},i[o].exclude={...t[o].exclude,...e[o].exclude};for(const s in i[o].include)i[o].include[s]&&i[o].exclude[s]&&delete i[o].include[s]}return i}function at(t,e=10){const{code:l,included:i,sorted:o}=t,s=l.length;if(i>s)return[];if(i==0){const a=$(s);for(const c of a)l.forEach(d=>c.exclude[d]=!0);return[a]}let n=[],r=0;for(let a=0;a<=s-i;a++){let c=[],d={};for(d[a]=l[a],c.push(d);Object.keys(c.slice(-1)[0]).length<i;){const p=[];for(const m of c){const k=Object.keys(m).length,f=Math.floor(Object.keys(m).sort((g,M)=>M-g)[0]);for(let g=f+1;g<=s-(i-k);g++){const M={...m};if(M[g]=l[g],p.push(M),r++,r>=1e3)return n}}c=p}n=n.concat(c)}const u=[];for(const a of n){if(o==0){const d=$(s);for(const m in a)for(let k=0;k<s;k++)k==m?d[k].exclude[l[m]]=!0:d[k].include[l[m]]=!0;const p=l.filter(m=>!Object.values(a).includes(m));d.forEach(m=>{p.forEach(k=>{m.exclude[k]=!0})}),u.push(d);continue}const c=[...He(Object.keys(a).map(d=>Math.floor(d)),o)];for(const d of c){const p=$(s);for(const f of d)p[f].include[l[f]]=!0,"0".repeat(e).split("").map((g,M)=>M).filter(g=>g!=l[f]).forEach(g=>p[f].exclude[g]=!0);const m=Object.keys(a).map(Math.floor).filter(f=>!d.includes(f));for(const f of m)for(let g=0;g<s;g++)g==f?p[g].exclude[l[f]]=!0:d.includes(g)||(p[g].include[l[f]]=!0);const k=l.filter(f=>!Object.values(a).includes(f));p.forEach(f=>{k.forEach(g=>{f.exclude[g]=!0})}),u.push(p)}}return u}function*He(t,e){for(let l=0;l<t.length;l++)if(e===1)yield[t[l]];else{const i=He(t.slice(l+1,t.length),e-1);for(let o of i)yield[t[l],...o]}}const ct=t=>t[Math.floor(Math.random()*t.length)],ht=t=>t.sort((e,l)=>Math.random()<.5?-1:1);function mt(t={}){let{solution:e,codeLength:l,maxHints:i,base:o,debug:s,maxTries:n}=t;s&&console.time("total"),l=l||3,i=i&&i>1?i:5,o=o||10,s=!!s,n=n||-1,(!e||l!=e.length)&&(e="0".repeat(l).split("").map(d=>Math.floor(Math.random()*o)));const r=e.filter((d,p,m)=>m.indexOf(d)==p).length,u=[];let a,c=0;s&&console.log(`solution: ${e.join(", ")} | maxIncluded: ${r}`);do{u.length>=i&&u.splice(0,u.length);const d=Math.floor(Math.random()*(r+1)),p=[];let m=d==l?Math.floor(Math.random()*(d-1)):Math.floor(Math.random()*(d+1));s&&console.log(`include ${d} sort ${m}`),s&&console.time("included");for(let f=0;f<d;f++){let g;do g=ct(e);while(p.includes(g));p.push(g)}s&&console.timeEnd("included"),s&&console.time("nonincluded");for(let f=0;f<l-d;f++){let g;do g=Math.floor(Math.random()*o);while(e.includes(g));p.push(g)}s&&console.timeEnd("nonincluded");const k=()=>p.reduce((f,g)=>f+(e.indexOf(g)==p.indexOf(g)?1:0),0);for(s&&console.time("shuffle");k()!=m;)ht(p);s&&console.timeEnd("shuffle"),u.push({code:p,included:d,sorted:m}),a=rt(u,o),c++}while((a.length!=1||!a[0].every((d,p)=>e[p]==d))&&(n==-1||c<n));return s&&console.timeEnd("total"),u}const _t=import.meta.url,gt=10;onmessage=t=>{const e=mt({...t.data,maxTries:gt});e&&postMessage(e)};function Mt(t,e,l,i){if(window.Worker){delete l.riddle;for(let o=0;o<e;o++){const s=new Worker(new URL(_t).href,{type:"module"});s.postMessage(t),s.onmessage=n=>{l.riddle||(l.riddle=n.data,i())}}}}export{Et as R,Mt as g,rt as s};
